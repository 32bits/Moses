<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Moses documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>Moses</h1>


<h2>Contents</h2>
<ul>
<li><a href="#Array_functions">Array functions </a></li>
<li><a href="#Utility_functions">Utility functions </a></li>
<li><a href="#Object_functions">Object functions </a></li>
<li><a href="#each">each </a></li>
<li><a href="#Chaining">Chaining </a></li>
<li><a href="#License">License </a></li>
</ul>


<h2>Topics</h2>
<ul class="nowrap">
  <li><strong>tutorial.md</strong></li>
</ul>
<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../index.html">moses</a></li>
</ul>

</div>

<div id="content">

<h1>Topic <code>tutorial.md</code></h1>

    Moses: an utility-belt library for Lua</p>

<p><strong>Moses</strong> is a Lua utility library which provides support for functional programming.
It complements built-in Lua functions, making easier operations on arrays, lists, collections, objects, and a lot more.<br/>
<strong>Moses</strong> was deeply inspired by <a href="http://documentcloud.github.com/underscore/">Underscore.js</a>. </p>

<h1>Requiring Moses</h1>


<pre>
<span class="comment">-- Minimal code
</span><span class="keyword">local</span> _ = <span class="global">require</span> (<span class="string">"moses"</span>)
</pre>


<h1>Collection functions samples</h1>

<p><a name="each"></a></p>
<h2>each</h2>

<p>Prints a flat array contents:</p>


<pre>
_.each({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span>
</pre>


<p>Iterates over non numeric keys:</p>


<pre>
_.each({one = <span class="number">1</span>, two = <span class="number">2</span>, three = <span class="number">3</span>},<span class="global">print</span>)

<span class="comment">-- =&gt; one 1
</span><span class="comment">-- =&gt; two 2
</span><span class="comment">-- =&gt; three 3
</span>
</pre>


<p>Can reference an outer table or the passed-in table:</p>


<pre>
t = {<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>}
_.each(t,<span class="keyword">function</span>(i,v)
  t[i] = v:rep(<span class="number">2</span>)
  <span class="global">print</span>(t[i])
<span class="keyword">end</span>)

<span class="comment">-- =&gt; 1 aa
</span><span class="comment">-- =&gt; 2 bb
</span><span class="comment">-- =&gt; 3 cc
</span>
</pre>


<h3>eachi</h3>

<p>Iterates only on integer keys in a sparse array or map-like table:</p>


<pre>
_.eachi({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span>
</pre>



<pre>
<span class="keyword">local</span> t = {a = <span class="number">1</span>, b = <span class="number">2</span>, [<span class="number">0</span>] = <span class="number">1</span>, [-<span class="number">1</span>] = <span class="number">6</span>, <span class="number">3</span>, x = <span class="number">4</span>, <span class="number">5</span>}
_.eachi(t,<span class="keyword">function</span>(i,v)
    <span class="global">print</span>(i,v)
<span class="keyword">end</span>)

<span class="comment">-- =&gt; -1 6
</span><span class="comment">-- =&gt; 0 1
</span><span class="comment">-- =&gt; 1 3
</span><span class="comment">-- =&gt; 2 5
</span>
</pre>


<h3>count</h3>

<p>Counts the occurences of value in a given list</p>


<pre>
<span class="global">print</span>(_.count({<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>},<span class="number">1</span>))
<span class="global">print</span>(_.count({<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>},<span class="number">2</span>))
<span class="global">print</span>(_.count({<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>},<span class="number">3</span>))
<span class="global">print</span>(_.count({<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>},<span class="keyword">false</span>))
<span class="global">print</span>(_.count({<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>},<span class="keyword">true</span>))

<span class="comment">-- =&gt; 2
</span><span class="comment">-- =&gt; 2
</span><span class="comment">-- =&gt; 4
</span><span class="comment">-- =&gt; 2
</span><span class="comment">-- =&gt; 1
</span>
</pre>


<p>Returns the size of the list in case value is not provided.</p>


<pre>
<span class="global">print</span>(_.count({<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>}))

<span class="comment">-- =&gt; 5
</span>
</pre>


<h3>countf</h3>

<p>Count the occurences of values passing an iterator test</p>


<pre>
<span class="global">print</span>(_.countf({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>}, <span class="keyword">function</span>(i,v)
    <span class="keyword">return</span> v%<span class="number">2</span>==<span class="number">0</span>
<span class="keyword">end</span>))

<span class="comment">-- =&gt; 3
</span>
<span class="global">print</span>(_.countf({<span class="global">print</span>, <span class="global">pairs</span>, <span class="global">os</span>, <span class="global">assert</span>, <span class="global">ipairs</span>}, <span class="keyword">function</span>(i,v)
    <span class="keyword">return</span> <span class="global">type</span>(v)==<span class="string">'function'</span>
<span class="keyword">end</span>))

<span class="comment">-- =&gt; 4
</span>
</pre>


<h3>cycle</h3>

<p>Returns an iterator function which loops on each key-pairs of a given collection and restarts looping again <code>n</code> times.
If <code>n</code> is not provided, loops forever.</p>


<pre>
<span class="keyword">local</span> t = {<span class="string">'a,'</span>b<span class="string">','</span>c<span class="string">'}
for k,v in _.cycle(t, 2) do
    print(k,v)
end

-- =&gt; 1 '</span>a<span class="string">'
-- =&gt; 2 '</span>b<span class="string">'
-- =&gt; 3 '</span>c<span class="string">'
-- =&gt; 1 '</span>a<span class="string">'
-- =&gt; 2 '</span>b<span class="string">'
-- =&gt; 3 '</span>c'
</pre>


<p>Supports array-like tables and map-like tables:</p>


<pre>
<span class="keyword">local</span> t = {x = <span class="number">1</span>, y = <span class="number">2</span>, z = <span class="number">3</span>}
<span class="keyword">for</span> k,v <span class="keyword">in</span> _.cycle(t) <span class="keyword">do</span>
    <span class="global">print</span>(k,v)
<span class="keyword">end</span>

<span class="comment">-- =&gt; y    2
</span><span class="comment">-- =&gt; x 1
</span><span class="comment">-- =&gt; z 3
</span><span class="comment">-- =&gt; y 2
</span><span class="comment">-- =&gt; x 1
</span><span class="comment">-- =&gt; z 3
</span><span class="comment">-- =&gt; ...
</span>
</pre>


<h3>map</h3>

<p>Executes a function on each key-value pairs:</p>


<pre>
<span class="keyword">local</span> v = _.map({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="keyword">function</span>(i,v)
  <span class="keyword">return</span> v+<span class="number">10</span>
<span class="keyword">end</span>))
_.each(v,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 11
</span><span class="comment">-- =&gt; 2 12
</span><span class="comment">-- =&gt; 3 13
</span>
</pre>



<pre>
<span class="keyword">local</span> v = _.map({a = <span class="number">1</span>, b = <span class="number">2</span>},<span class="keyword">function</span>(k,v)
  <span class="keyword">return</span> k..v
<span class="keyword">end</span>
_.each(v,<span class="global">print</span>)

<span class="comment">-- =&gt; a a1
</span><span class="comment">-- =&gt; b b2
</span>
</pre>


<h3>reduce</h3>

<p>Sums all values:</p>


<pre>
<span class="keyword">local</span> r = _.reduce({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>},<span class="keyword">function</span>(memo,v)
  <span class="keyword">return</span> memo+v
<span class="keyword">end</span>)
<span class="global">print</span>(r)

<span class="comment">-- =&gt; 10
</span>
</pre>


<p>Concatenates all values:</p>


<pre>
<span class="keyword">local</span> r = _.reduce({<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>},<span class="keyword">function</span>(memo,v)
  <span class="keyword">return</span> memo..v
<span class="keyword">end</span>)
<span class="global">print</span>(r)

<span class="comment">-- =&gt; abcd
</span>
</pre>


<h3>reduceRight</h3>

<p>Reduces from right to left:</p>


<pre>
<span class="keyword">local</span> initial_state = <span class="number">256</span>
<span class="keyword">local</span> r = _.reduceRight({<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">16</span>},<span class="keyword">function</span>(memo,v)
  <span class="keyword">return</span> memo/v
<span class="keyword">end</span>,initial_state)
<span class="global">print</span>(r)

<span class="comment">-- =&gt; 2
</span>
</pre>


<h3>mapReduce</h3>

<p>Reduces while saving intermediate states:</p>


<pre>
<span class="keyword">local</span> v = _.mapReduce({<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>},<span class="keyword">function</span>(memo,v)
  <span class="keyword">return</span> memo..v
<span class="keyword">end</span>)
_.each(v,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 a
</span><span class="comment">-- =&gt; 2 ab
</span><span class="comment">-- =&gt; 3 abc
</span>
</pre>


<h3>mapReduceRight</h3>

<p>Reduces from right to left, while saving intermediate states:</p>


<pre>
<span class="keyword">local</span> v = _.mapReduceRight({<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>},<span class="keyword">function</span>(memo,v)
  <span class="keyword">return</span> memo..v
<span class="keyword">end</span>)
_.each(v,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 "c"
</span><span class="comment">-- =&gt; 2 "cb"
</span><span class="comment">-- =&gt; 3 "cba"
</span>
</pre>


<h3>include</h3>

<p>Looks for a value in a collection:</p>


<pre>
<span class="global">print</span>(_.include({<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">16</span>,<span class="number">29</span>},<span class="number">16</span>))
_.include({<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">16</span>,<span class="number">29</span>},<span class="number">1</span>)

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
<span class="keyword">local</span> complex_table = {<span class="number">18</span>,{<span class="number">2</span>,{<span class="number">3</span>}}}
<span class="keyword">local</span> collection = {<span class="number">6</span>,{<span class="number">18</span>,{<span class="number">2</span>,<span class="number">6</span>}},<span class="number">10</span>,{<span class="number">18</span>,{<span class="number">2</span>,{<span class="number">3</span>}}},<span class="number">29</span>}
<span class="global">print</span>(_.include(collection, complex_table)

<span class="comment">-- =&gt; true
</span>
</pre>


<p>Handles iterator functions:</p>


<pre>
<span class="keyword">local</span> functions isUpper(v)
  <span class="keyword">return</span> v:upper()==v
<span class="keyword">end</span>
<span class="global">print</span>(_.include({<span class="string">'a'</span>,<span class="string">'B'</span>,<span class="string">'c'</span>},isUpper))

<span class="comment">-- =&gt; true
</span>
</pre>


<h3>detect</h3>

<p>Returns a value key in a collection:</p>


<pre>
<span class="global">print</span>(_.detect({<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">16</span>},<span class="number">8</span>))
<span class="global">print</span>(_.detect({<span class="keyword">nil</span>,<span class="keyword">true</span>,<span class="number">0</span>,<span class="keyword">true</span>,<span class="keyword">true</span>},<span class="keyword">false</span>))

<span class="comment">-- =&gt; 2
</span><span class="comment">-- =&gt; nil
</span>
<span class="keyword">local</span> complex_table = {<span class="number">18</span>,{<span class="number">2</span>,<span class="number">6</span>}}
<span class="keyword">local</span> collection = {<span class="number">6</span>,{<span class="number">18</span>,{<span class="number">2</span>,<span class="number">6</span>}},<span class="number">10</span>,{<span class="number">18</span>,{<span class="number">2</span>,{<span class="number">3</span>}}},<span class="number">29</span>}
<span class="global">print</span>(_.detect(collection, complex_table)

<span class="comment">-- =&gt; 2
</span>
</pre>


<p>Handles iterator functions:</p>


<pre>
<span class="keyword">local</span> functions isUpper(v)
  <span class="keyword">return</span> v:upper()==v
<span class="keyword">end</span>
<span class="global">print</span>(_.detect({<span class="string">'a'</span>,<span class="string">'B'</span>,<span class="string">'c'</span>},isUpper))

<span class="comment">-- =&gt; 2
</span>
</pre>


<h3>contains</h3>

<p>Returns true if the passed-in value was found in a given list</p>


<pre>
<span class="global">print</span>(_.contains({<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">16</span>},<span class="number">8</span>))

<span class="comment">-- =&gt; true
</span>
<span class="global">print</span>(_.contains({<span class="keyword">nil</span>,<span class="keyword">true</span>,<span class="number">0</span>,<span class="keyword">true</span>,<span class="keyword">true</span>},<span class="keyword">false</span>))

<span class="comment">-- =&gt; false
</span>
</pre>


<p>It can lookup for objects, and accepts iterator functions aswell:</p>


<pre>
<span class="global">print</span>(_.contains({<span class="number">6</span>,{<span class="number">18</span>,{<span class="number">2</span>,<span class="number">6</span>}},<span class="number">10</span>,{<span class="number">18</span>,{<span class="number">2</span>,{<span class="number">3</span>}}},<span class="number">29</span>},{<span class="number">18</span>,{<span class="number">2</span>,<span class="number">6</span>}}))

<span class="comment">-- =&gt; true
</span>
<span class="global">print</span>(_.contains({<span class="string">'a'</span>,<span class="string">'B'</span>,<span class="string">'c'</span>}, <span class="keyword">function</span>(array_value)
    <span class="keyword">return</span> (array_value:upper() == array_value)
<span class="keyword">end</span>))

<span class="comment">-- =&gt; true
</span>
</pre>


<h3>findWhere</h3>

<p>Looks through a list and returns the first value that matches all of the key-value pairs listed in properties. </p>


<pre>
<span class="keyword">local</span> a = {a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>}
<span class="keyword">local</span> b = {a = <span class="number">2</span>, b = <span class="number">3</span>, d = <span class="number">4</span>}
<span class="keyword">local</span> c = {a = <span class="number">3</span>, b = <span class="number">4</span>, e = <span class="number">5</span>}
<span class="global">print</span>(_.findWhere({a, b, c}, {a = <span class="number">3</span>, b = <span class="number">4</span>}) == c)

<span class="comment">-- =&gt; true
</span>
</pre>


<h3>select</h3>

<p>Collect values passing a truth test:</p>


<pre>
<span class="keyword">local</span> even = _.<span class="global">select</span>({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>}, <span class="keyword">function</span>(key,value)
  <span class="keyword">return</span> (value%<span class="number">2</span>==<span class="number">0</span>)
<span class="keyword">end</span>)
_.each(even, <span class="global">print</span>)

<span class="comment">-- =&gt; 1 2
</span><span class="comment">-- =&gt; 2 4
</span><span class="comment">-- =&gt; 3 6
</span>
<span class="keyword">local</span> odd = _.<span class="global">select</span>({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>}, <span class="keyword">function</span>(key,value)
  <span class="keyword">return</span> (value%<span class="number">2</span>~=<span class="number">0</span>)
<span class="keyword">end</span>)
_.each(odd, <span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 3 5
</span><span class="comment">-- =&gt; 4 7
</span>
</pre>


<h3>reject</h3>

<p>Trims out values failing a truth test:</p>


<pre>
<span class="keyword">local</span> odd = _.reject({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>}, <span class="keyword">function</span>(key,value)
  <span class="keyword">return</span> (value%<span class="number">2</span>==<span class="number">0</span>)
<span class="keyword">end</span>)
_.each(odd, <span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 3 5
</span><span class="comment">-- =&gt; 4 7
</span>
<span class="keyword">local</span> even = _.reject({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>}, <span class="keyword">function</span>(key,value)
  <span class="keyword">return</span> (value%<span class="number">2</span>~=<span class="number">0</span>)
<span class="keyword">end</span>)

<span class="comment">-- =&gt; 1 2
</span><span class="comment">-- =&gt; 2 4
</span><span class="comment">-- =&gt; 3 6
</span>
</pre>


<h3>all</h3>

<p>Returns whether all elements pass a truth test:</p>


<pre>
<span class="global">print</span>(_.all({<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>}, <span class="keyword">function</span>(key,value)
          <span class="keyword">return</span> (value%<span class="number">2</span>==<span class="number">0</span>)
        <span class="keyword">end</span>))

<span class="comment">-- =&gt; true
</span>
</pre>


<h3>invoke</h3>

<p>Invokes a given function on each object in a collection:</p>


<pre>
<span class="keyword">local</span> results = _.invoke({<span class="string">'a'</span>,<span class="string">'bea'</span>,<span class="string">'cdhza'</span>},<span class="global">string</span>.len)
_.each(results, <span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 1 3
</span><span class="comment">-- =&gt; 1 5
</span>
</pre>


<p>Can reference the method of the same name in each object:</p>


<pre>
<span class="keyword">local</span> a = {}
<span class="keyword">function</span> a:call() <span class="keyword">return</span> <span class="string">'a'</span> <span class="keyword">end</span>
<span class="keyword">local</span> b, c, d = {}, {}, {}
b.call, c.call, d.call = a.call, a.call, a.call

<span class="keyword">local</span> results = _.invoke({a,b,c,d},<span class="string">'call'</span>)
_.each(results, <span class="global">print</span>)

<span class="comment">-- =&gt; 1 a
</span><span class="comment">-- =&gt; 2 a
</span><span class="comment">-- =&gt; 3 a
</span><span class="comment">-- =&gt; 4 a
</span>
</pre>


<h3>pluck</h3>

<p>Fetches values that a specific property takes in a collection of objects:</p>


<pre>
<span class="keyword">local</span> peoples = {
  {name = <span class="string">'John'</span>, age = <span class="number">23</span>},{name = <span class="string">'Peter'</span>, age = <span class="number">17</span>},
  {name = <span class="string">'Steve'</span>, age = <span class="number">15</span>},{age = <span class="number">33</span>}}

<span class="keyword">local</span> ages = _.pluck(peoples,<span class="string">'age'</span>)
_.each(ages,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 23
</span><span class="comment">-- =&gt; 2 17
</span><span class="comment">-- =&gt; 3 15
</span><span class="comment">-- =&gt; 4 33
</span>
<span class="keyword">local</span> names = _.pluck(peoples,<span class="string">'name'</span>)
_.each(names,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 John
</span><span class="comment">-- =&gt; 2 Peter
</span><span class="comment">-- =&gt; 3 Steve
</span>
</pre>


<h3>max</h3>

<p>Returns the maximum in a collection:</p>


<pre>
<span class="global">print</span>(_.max {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>})
<span class="global">print</span>(_.max {<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>})

<span class="comment">-- =&gt; 3
</span><span class="comment">-- =&gt; 'c'
</span>
</pre>


<p>Can handle an iterator function to extract a specific property:</p>


<pre>
<span class="keyword">local</span> peoples = {
  {name = <span class="string">'John'</span>, age = <span class="number">23</span>},{name = <span class="string">'Peter'</span>, age = <span class="number">17</span>},
  {name = <span class="string">'Steve'</span>, age = <span class="number">15</span>},{age = <span class="number">33</span>}}
<span class="global">print</span>(_.max(peoples,<span class="keyword">function</span>(people) <span class="keyword">return</span> people.age <span class="keyword">end</span>))

<span class="comment">-- =&gt; 33
</span>
</pre>


<h3>min</h3>

<p>Returns the minimum in a collection:</p>


<pre>
<span class="global">print</span>(_.min {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>})
<span class="global">print</span>(_.min {<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>})

<span class="comment">-- =&gt; 1
</span><span class="comment">-- =&gt; 'a'
</span>
</pre>


<p>Can handle an iterator function to extract a specific property:</p>


<pre>
<span class="keyword">local</span> peoples = {
  {name = <span class="string">'John'</span>, age = <span class="number">23</span>},{name = <span class="string">'Peter'</span>, age = <span class="number">17</span>},
  {name = <span class="string">'Steve'</span>, age = <span class="number">15</span>},{age = <span class="number">33</span>}}
<span class="global">print</span>(_.min(peoples,<span class="keyword">function</span>(people) <span class="keyword">return</span> people.age <span class="keyword">end</span>))

<span class="comment">-- =&gt; 15
</span>
</pre>


<h3>shuffle</h3>

<p>Shuffles a collection:</p>


<pre>
<span class="keyword">local</span> list = _.shuffle {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>}
_.each(list,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 3
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 6
</span><span class="comment">-- =&gt; 4 4
</span><span class="comment">-- =&gt; 5 1
</span><span class="comment">-- =&gt; 6 5
</span>
</pre>


<h3>same</h3>

<p>Tests whether all objects in each of the passed-in tables exists in both:</p>


<pre>
<span class="keyword">local</span> a = {<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>}
<span class="keyword">local</span> b = {<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>}
<span class="global">print</span>(_.same(a,b))

<span class="comment">-- =&gt; true
</span>
b[#b+<span class="number">1</span>] = <span class="string">'e'</span>
<span class="global">print</span>(_.same(a,b))

<span class="comment">-- =&gt; false
</span>
</pre>


<h3>sort</h3>

<p>Sorts a collection:</p>


<pre>
<span class="keyword">local</span> chars = _.sort({<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>})
_.each(chars,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 'a'
</span><span class="comment">-- =&gt; 2 'b'
</span><span class="comment">-- =&gt; 3 'c'
</span><span class="comment">-- =&gt; 4 'd'
</span>
</pre>


<p>Handles custom comparison functions:</p>


<pre>
<span class="keyword">local</span> chars = _.sort({<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>}, <span class="keyword">function</span>(a,b)
  <span class="keyword">return</span> a:byte() &gt; b:byte()
<span class="keyword">end</span>)

<span class="comment">-- =&gt; 1 'd'
</span><span class="comment">-- =&gt; 2 'c'
</span><span class="comment">-- =&gt; 3 'b'
</span><span class="comment">-- =&gt; 4 'a'
</span>
</pre>


<h4>toArray</h4>

<p>Folds all passed-in args in an array:</p>


<pre>
<span class="keyword">local</span> array = _.toArray(<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="string">'d'</span>,<span class="string">'a'</span>,<span class="number">0</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 8
</span><span class="comment">-- =&gt; 4 'd'
</span><span class="comment">-- =&gt; 5 'a'
</span><span class="comment">-- =&gt; 6 0
</span>
</pre>


<h3>groupBy</h3>

<p>Groups values in a collection according to how they behave with respect to a given predicate:</p>


<pre>
<span class="keyword">local</span> set = _.groupBy({<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>},<span class="keyword">function</span>(i,value)
  <span class="keyword">return</span> value%<span class="number">2</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="string">'even'</span> <span class="keyword">or</span> <span class="string">'odd'</span>
<span class="keyword">end</span>)
_.each(set, <span class="keyword">function</span>(k,v)
  <span class="global">print</span>(<span class="string">'Subset'</span>,k)
  _.each(v,<span class="global">print</span>)
<span class="keyword">end</span>)

<span class="comment">-- =&gt; Subset odd
</span><span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 3 5
</span><span class="comment">-- =&gt; Subset even
</span><span class="comment">-- =&gt; 1 0
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 4
</span><span class="comment">-- =&gt; 4 6
</span>
<span class="keyword">local</span> set = _.groupBy({<span class="number">0</span>,<span class="string">'a'</span>,<span class="keyword">true</span>, <span class="keyword">false</span>,<span class="keyword">nil</span>,b,<span class="number">0.5</span>},<span class="keyword">function</span>(i,value)
  <span class="keyword">return</span> <span class="global">type</span>(value)
<span class="keyword">end</span>)
_.each(set, <span class="keyword">function</span>(k,v)
  <span class="global">print</span>(<span class="string">'Subset'</span>,k)
  _.each(v,<span class="global">print</span>)
<span class="keyword">end</span>)

<span class="comment">-- =&gt; Subset number
</span><span class="comment">-- =&gt; 1 0
</span><span class="comment">-- =&gt; 2 0.5
</span><span class="comment">-- =&gt; Subset string
</span><span class="comment">-- =&gt; 1 a
</span><span class="comment">-- =&gt; Subset boolean
</span><span class="comment">-- =&gt; 1 true
</span><span class="comment">-- =&gt; 2 false
</span>
</pre>


<h3>countBy</h3>

<p>Splits a collection in subsets and provide the count for each subset:</p>


<pre>
<span class="keyword">local</span> set = _.countBy({<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>},<span class="keyword">function</span>(i,value)
  <span class="keyword">return</span> value%<span class="number">2</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="string">'even'</span> <span class="keyword">or</span> <span class="string">'odd'</span>
<span class="keyword">end</span>)
_.each(set,<span class="global">print</span>)

<span class="comment">-- =&gt; odd 3
</span><span class="comment">-- =&gt; even 4
</span>
</pre>


<h3>size</h3>

<p>Provide the count for the very number of items in a collection:</p>


<pre>
<span class="global">print</span>(_.size {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>})
<span class="global">print</span>(_.size {one = <span class="number">1</span>, two = <span class="number">2</span>})

<span class="comment">-- =&gt; 3
</span><span class="comment">-- =&gt; 2
</span>
</pre>


<p>Counts the number of its arguments:</p>


<pre>
<span class="global">print</span>(_.size(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))
<span class="global">print</span>(_.size(<span class="string">'a'</span>,<span class="string">'b'</span>,{}, <span class="keyword">function</span>() <span class="keyword">end</span>))

<span class="comment">-- =&gt; 3
</span><span class="comment">-- =&gt; 4
</span>
</pre>


<h3>containsKeys</h3>

<p>Checks whether a table has all the keys existing in another table:</p>


<pre>
<span class="global">print</span>(_.contains({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>},{<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}))
<span class="global">print</span>(_.contains({<span class="number">1</span>,<span class="number">2</span>,<span class="string">'d'</span>,<span class="string">'b'</span>},{<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>}))
<span class="global">print</span>(_.contains({x = <span class="number">1</span>, y = <span class="number">2</span>, z = <span class="number">3</span>},{x = <span class="number">1</span>, y = <span class="number">2</span>}))

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span>
</pre>


<h3>sameKeys</h3>

<p>Checks whether both tables features the same keys:</p>


<pre>
<span class="global">print</span>(_.sameKeys({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>},{<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}))
<span class="global">print</span>(_.sameKeys({<span class="number">1</span>,<span class="number">2</span>,<span class="string">'d'</span>,<span class="string">'b'</span>},{<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>}))
<span class="global">print</span>(_.sameKeys({x = <span class="number">1</span>, y = <span class="number">2</span>, z = <span class="number">3</span>},{x = <span class="number">1</span>, y = <span class="number">2</span>}))

<span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
</pre>


<p><a name="Array_functions"></a></p>
<h2>Array functions</h2>

<h3>reverse</h3>

<p>Reverses an array:</p>


<pre>
<span class="keyword">local</span> array = _.reverse({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">'d'</span>})
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 'd'
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 3 2
</span><span class="comment">-- =&gt; 4 1
</span>
</pre>


<h3>selectWhile</h3>

<p>Collects values as long as they pass a given test. Breaks on the first falsy test:</p>


<pre>
<span class="keyword">local</span> selected = _.selectWhile({<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">8</span>}, <span class="keyword">function</span>(i,v)
  <span class="keyword">return</span> v%<span class="number">2</span>==<span class="number">0</span>
<span class="keyword">end</span>)
_.each(selected,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 2
</span><span class="comment">-- =&gt; 2 4
</span>
</pre>


<h3>dropWhile</h3>

<p>Trims out values as long as they pass a given test. Breaks on the first truthy test:</p>


<pre>
<span class="keyword">local</span> selected = _.dropWhile({<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">8</span>}, <span class="keyword">function</span>(i,v)
  <span class="keyword">return</span> v%<span class="number">2</span>==<span class="number">0</span>
<span class="keyword">end</span>)
_.each(selected,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 5
</span><span class="comment">-- =&gt; 2 8
</span>
</pre>


<h3>sortedIndex</h3>

<p>Returns the index at which a value should be inserted to preserve order:</p>


<pre>
<span class="keyword">local</span> index = _.sortedIndex({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="number">4</span>)
<span class="global">print</span>(index)

<span class="comment">-- =&gt; 4
</span>
</pre>


<p>Handles custom comparison functions:</p>


<pre>
<span class="keyword">local</span> comp = <span class="keyword">function</span>(a,b) <span class="keyword">return</span> a&lt;b <span class="keyword">end</span>
<span class="keyword">local</span> index = _.sortedIndex({-<span class="number">5</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">4</span>},<span class="number">3</span>,comp)
<span class="global">print</span>(index)

<span class="comment">-- =&gt; 3
</span>
</pre>


<h3>indexOf</h3>

<p>Returns the index of a value in an array:</p>


<pre>
<span class="keyword">local</span> index = _.indexOf({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="number">2</span>),
<span class="global">print</span>(index)

<span class="comment">-- =&gt; 2
</span>
</pre>


<h3>lastIndexOf</h3>

<p>Returns the index of the last occurence of a given value in an array:</p>


<pre>
<span class="keyword">local</span> index = _.lastIndexOf({<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="number">2</span>),
<span class="global">print</span>(index)

<span class="comment">-- =&gt; 3
</span>
</pre>


<h3>add</h3>

<p>Adds given values at the top of an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>}
_.add(array,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 4
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 3 2
</span><span class="comment">-- =&gt; 4 1
</span><span class="comment">-- =&gt; 5 1
</span>
</pre>


<h3>push</h3>

<p>Adds given values at the end of an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>}
_.push(array,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 1
</span><span class="comment">-- =&gt; 3 2
</span><span class="comment">-- =&gt; 4 3
</span><span class="comment">-- =&gt; 5 4
</span>
</pre>


<h3>pop</h3>

<p>Removes and returns the first value in an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}
<span class="global">print</span>(_.pop(array))

<span class="comment">-- =&gt; 1
</span>
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 2
</span><span class="comment">-- =&gt; 2 3
</span>
</pre>


<h3>unshift</h3>

<p>Removes and returns the last value in an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}
<span class="global">print</span>(_.unshift(array))

<span class="comment">-- =&gt; 3
</span>
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span>
</pre>


<h3>removeRange</h3>

<p>Trims out all values index within a range:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>}
array = _.removeRange(array, <span class="number">3</span>,<span class="number">8</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 9
</span>
</pre>


<h3>chunk</h3>

<p>Iterates over an array chunking together. Values are chunked on the basis of the return
value of <code>f(key,value,...)</code>. Consecutive elements which return the same value are chunked together.</p>


<pre>
<span class="keyword">local</span> t = {<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>}
<span class="keyword">local</span> v = _.chunk(t, <span class="keyword">function</span>(k,v) <span class="keyword">return</span> v%<span class="number">2</span>==<span class="number">0</span> <span class="keyword">end</span>)
_.each(v,<span class="keyword">function</span>(k,v)
    <span class="global">print</span>(<span class="string">'table'</span>,k)
    _.each(v,<span class="global">print</span>)
<span class="keyword">end</span>)

<span class="comment">-- =&gt; table    1
</span><span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 1
</span><span class="comment">-- =&gt; table 2
</span><span class="comment">-- =&gt; 1 2
</span><span class="comment">-- =&gt; table 3
</span><span class="comment">-- =&gt; 1 3
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; table 4
</span><span class="comment">-- =&gt; 1 4
</span>
</pre>


<h3>slice</h3>

<p>Slices and returns a part of an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>}
array = _.slice(array, <span class="number">3</span>,<span class="number">6</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 3
</span><span class="comment">-- =&gt; 2 4
</span><span class="comment">-- =&gt; 3 5
</span><span class="comment">-- =&gt; 4 6
</span>
</pre>


<h3>first</h3>

<p>Returns the first N elements in an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>}
array = _.first(array,<span class="number">3</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span>
</pre>


<h3>initial</h3>

<p>Excludes the last N elements in an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>}
array = _.initial(array,<span class="number">5</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span><span class="comment">-- =&gt; 4 4
</span>
</pre>


<h3>last</h3>

<p>Returns the last N elements in an array:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>}
array = _.last(array,<span class="number">3</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 7
</span><span class="comment">-- =&gt; 2 8
</span><span class="comment">-- =&gt; 3 9
</span>
</pre>


<h3>rest</h3>

<p>Trims out all values indexed before <tt>index</tt>:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>}
array = _.rest(array,<span class="number">6</span>)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 6
</span><span class="comment">-- =&gt; 2 7
</span><span class="comment">-- =&gt; 3 8
</span><span class="comment">-- =&gt; 4 9
</span>
</pre>


<h3>compact</h3>

<p>Trims out all falsy values:</p>


<pre>
<span class="keyword">local</span> array = _.compact {a,<span class="string">'aa'</span>,<span class="keyword">false</span>,<span class="string">'bb'</span>,<span class="keyword">true</span>}
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 aa
</span><span class="comment">-- =&gt; 2 bb
</span><span class="comment">-- =&gt; 3 true
</span>
</pre>


<h3>flatten</h3>

<p>Flattens a nested array:</p>


<pre>
<span class="keyword">local</span> array = _.flatten({<span class="number">1</span>,{<span class="number">2</span>,<span class="number">3</span>},{<span class="number">4</span>,<span class="number">5</span>,{<span class="number">6</span>,<span class="number">7</span>}}})
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span><span class="comment">-- =&gt; 4 4
</span><span class="comment">-- =&gt; 5 5
</span><span class="comment">-- =&gt; 6 6
</span><span class="comment">-- =&gt; 7 7
</span>
</pre>


<h3>difference</h3>

<p>Returns values in the given array not present in a second array.</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="string">'a'</span>,<span class="number">4</span>,<span class="number">5</span>}
array = _.difference(array,{<span class="number">1</span>,<span class="string">'a'</span>})
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 2
</span><span class="comment">-- =&gt; 2 4
</span><span class="comment">-- =&gt; 3 5
</span>
</pre>


<h3>symmetric_difference</h3>

<p>Returns values in the first array not present in the second and also values in the second array not present in the first one:</p>


<pre>
<span class="keyword">local</span> array = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}
<span class="keyword">local</span> array2 = {<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>}
_.each(_.symmetric_difference(array, array2),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 2
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 3 4
</span><span class="comment">-- =&gt; 4 5
</span>
</pre>


<h3>uniq</h3>

<p>Produces duplicate-free arrays:</p>


<pre>
<span class="keyword">local</span> array = _.uniq({<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">5</span>}
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span><span class="comment">-- =&gt; 4 4
</span><span class="comment">-- =&gt; 5 5
</span>
</pre>


<h3>union</h3>

<p>Produces a duplicate-free union of all passed-in arrays:</p>


<pre>
<span class="keyword">local</span> A = {<span class="string">'a'</span>}
<span class="keyword">local</span> B = {<span class="string">'a'</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}
<span class="keyword">local</span> C = {<span class="number">2</span>,<span class="number">10</span>}
<span class="keyword">local</span> array = _.union(A,B,C)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 'a'
</span><span class="comment">-- =&gt; 2 1
</span><span class="comment">-- =&gt; 3 2
</span><span class="comment">-- =&gt; 4 3
</span><span class="comment">-- =&gt; 5 10
</span>
</pre>


<h3>intersection</h3>

<p>Returns the intersection (common-part) of all passed-in arrays:</p>


<pre>
<span class="keyword">local</span> A = {<span class="string">'a'</span>}
<span class="keyword">local</span> B = {<span class="string">'a'</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}
<span class="keyword">local</span> C = {<span class="number">2</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="string">'a'</span>}
<span class="keyword">local</span> array = _.intersection(A,B,C)
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 a
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 1
</span>
</pre>


<h3>zip</h3>

<p>Zips values from different arrays, on the basis on their common keys:</p>


<pre>
<span class="keyword">local</span> names = {<span class="string">'Bob'</span>,<span class="string">'Alice'</span>,<span class="string">'James'</span>}
<span class="keyword">local</span> ages = {<span class="number">22</span>, <span class="number">23</span>}
<span class="keyword">local</span> array = _.zip(names,ages)
_.each(array,<span class="keyword">function</span>(k,v)
  <span class="global">print</span>(<span class="string">'subset'</span>,k)
  _.each(v,<span class="global">print</span>)
<span class="keyword">end</span>)

<span class="comment">-- =&gt; subset 1
</span><span class="comment">-- =&gt; 1 Bob
</span><span class="comment">-- =&gt; 2 22
</span><span class="comment">-- =&gt; subset 2
</span><span class="comment">-- =&gt; 1 Alice
</span><span class="comment">-- =&gt; 2 23
</span><span class="comment">-- =&gt; subset 3
</span><span class="comment">-- =&gt; 1 James
</span>
</pre>


<h3>append</h3>

<p>Appends two arrays:</p>


<pre>
<span class="keyword">local</span> array = _.append({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},{<span class="string">'a'</span>,<span class="string">'b'</span>})
_.each(array,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 4 a
</span><span class="comment">-- =&gt; 5 b
</span>
</pre>


<h3>range</h3>

<p>Generates arithmetic progressions:</p>


<pre>
_.each(_.range(<span class="number">1</span>,<span class="number">4</span>),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 2 3
</span><span class="comment">-- =&gt; 4 4
</span>
_.each(_.range(<span class="number">3</span>),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 0
</span><span class="comment">-- =&gt; 2 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 4 3
</span>
_.each(_.range(<span class="number">0</span>,<span class="number">2</span>,<span class="number">0.7</span>),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 0
</span><span class="comment">-- =&gt; 2 0.7
</span><span class="comment">-- =&gt; 3 1.4
</span>
</pre>


<h3>invert</h3>

<p>Switches <tt>key-value</tt> pairs:</p>


<pre>
_.each(_.invert {<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>},<span class="global">print</span>)

<span class="comment">-- =&gt; a 1
</span><span class="comment">-- =&gt; b 2
</span><span class="comment">-- =&gt; c 3
</span>
</pre>


<h3>concat</h3>

<p>Concatenates a given array values:</p>


<pre>
<span class="global">print</span>(_.concat({<span class="string">'a'</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="string">'b'</span>}))

<span class="comment">-- =&gt; a101b
</span>
</pre>


<p><a name="Utility_functions"></a></p>
<h2>Utility functions</h2>

<h3>identity</h3>

<p>Returns the value passed. <br/>
This function is used internally as a default iterator.</p>


<pre>
<span class="global">print</span>(_.identity(<span class="number">1</span>))
<span class="global">print</span>(_.identity(<span class="keyword">false</span>))
<span class="global">print</span>(_.identity(<span class="string">'hello!'</span>))

<span class="comment">-- =&gt; 1
</span><span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; hello!
</span>
</pre>


<h3>once</h3>

<p>Produces a function that runs only once. Successive calls will not affect the output.</p>


<pre>
<span class="keyword">local</span> sq = _.once(<span class="keyword">function</span>(a) <span class="keyword">return</span> a*a <span class="keyword">end</span>)
<span class="keyword">for</span> i = <span class="number">1</span>,<span class="number">5</span> <span class="keyword">do</span> <span class="global">print</span>(i,sq(i)) <span class="keyword">end</span>

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 1
</span><span class="comment">-- =&gt; 3 1
</span><span class="comment">-- =&gt; 4 1
</span><span class="comment">-- =&gt; 5 1
</span>
</pre>


<h3>memoize</h3>

<p>Memoizes a slow-running function by caching the result.</p>


<pre>
<span class="keyword">local</span> <span class="keyword">function</span> fibonacci(n)
  <span class="keyword">return</span> n &lt; <span class="number">2</span> <span class="keyword">and</span> n <span class="keyword">or</span> fibonacci(n-<span class="number">1</span>)+fibonacci(n-<span class="number">2</span>)
<span class="keyword">end</span>
fibonacci = _.memoize(fibonacci)
<span class="global">print</span>(fibonacci(<span class="number">20</span>))

<span class="comment">-- =&gt; 1 1
</span>
</pre>


<h3>after</h3>

<p>Produces a function that will respond only after a given number of calls:</p>


<pre>
<span class="keyword">local</span> a = _.after(_.identity,<span class="number">3</span>)
<span class="keyword">for</span> i = <span class="number">1</span>,<span class="number">5</span> <span class="keyword">do</span> <span class="global">print</span>(i,a(i)) <span class="keyword">end</span>

<span class="comment">-- =&gt; 1 nil
</span><span class="comment">-- =&gt; 2 nil
</span><span class="comment">-- =&gt; 3 3
</span><span class="comment">-- =&gt; 4 4
</span><span class="comment">-- =&gt; 5 5
</span>
</pre>


<h3>compose</h3>

<p>Composes functions. Each function consumes the return value of the one that follows:</p>


<pre>
<span class="keyword">local</span> <span class="keyword">function</span> f(x) <span class="keyword">return</span> x^<span class="number">2</span> <span class="keyword">end</span>
<span class="keyword">local</span> <span class="keyword">function</span> g(x) <span class="keyword">return</span> x+<span class="number">1</span> <span class="keyword">end</span>
<span class="keyword">local</span> <span class="keyword">function</span> h(x) <span class="keyword">return</span> x/<span class="number">2</span> <span class="keyword">end</span>
<span class="keyword">local</span> compositae = _.compose(f,g,h)
<span class="global">print</span>(compositae(<span class="number">10</span>))
<span class="global">print</span>(compositae(<span class="number">20</span>))

<span class="comment">-- =&gt; 36
</span><span class="comment">-- =&gt; 121
</span>
</pre>


<h3>wrap</h3>

<p>Wraps a function inside a wrapper. Allows the wrapper to execute code before and after function runs:</p>


<pre>
<span class="keyword">local</span> greet = <span class="keyword">function</span>(name) <span class="keyword">return</span> <span class="string">"hi: "</span> .. name <span class="keyword">end</span>
<span class="keyword">local</span> greet_backwards = _.wrap(greet, <span class="keyword">function</span>(f,arg)
  <span class="keyword">return</span> f(arg) ..<span class="string">'\nhi: '</span> .. arg:reverse()
<span class="keyword">end</span>)
<span class="global">print</span>(greet_backwards(<span class="string">'John'</span>))

<span class="comment">-- =&gt; hi: John
</span><span class="comment">-- =&gt; hi: nhoJ
</span>
</pre>


<h3>times</h3>

<p>Spawns a given number of calls to a function:</p>


<pre>
<span class="keyword">local</span> f = (<span class="string">'Lua programming'</span>):gmatch(<span class="string">'.'</span>)
<span class="keyword">local</span> char3 = _.times(<span class="number">3</span>,f)
_.each(char3,<span class="global">print</span>)

<span class="comment">-- =&gt; 1 L
</span><span class="comment">-- =&gt; 2 u
</span><span class="comment">-- =&gt; 3 a
</span>
</pre>


<h3>bind</h3>

<p>Binds a value to be the first argument to a function:</p>


<pre>
<span class="keyword">local</span> sqrt2 = _.bind(<span class="global">math</span>.sqrt,<span class="number">2</span>)
<span class="global">print</span>(sqrt2())

<span class="comment">-- =&gt; 1.4142135623731
</span>
</pre>


<h3>bindn</h3>

<p>Binds a variable number of values to be the first arguments to a function:</p>


<pre>
<span class="keyword">local</span> <span class="keyword">function</span> out(...) <span class="keyword">return</span> <span class="global">table</span>.concat {...} <span class="keyword">end</span>
out = _.bindn(out,<span class="string">'OutPut'</span>,<span class="string">':'</span>,<span class="string">' '</span>)
<span class="global">print</span>(out(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))
<span class="global">print</span>(out(<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>))

<span class="comment">-- =&gt; OutPut: 123
</span><span class="comment">-- =&gt; OutPut: abcd
</span>
</pre>


<h3>uniqueId</h3>

<p>Returns an unique integer Id:</p>


<pre>
<span class="global">print</span>(_.uniqueid())

<span class="comment">-- =&gt; 1
</span>
<span class="global">print</span>(_.uniqueId(<span class="string">'ID%s'</span>))

<span class="comment">-- =&gt; ID2
</span>
</pre>


<p><a name="Object_functions"></a></p>
<h2>Object functions</h2>

<h3>keys</h3>

<p>Collects the names of an object properties:</p>


<pre>
_.each(_.keys({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span>
_.each(_.keys({x = <span class="number">0</span>, y = <span class="number">1</span>}),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 y
</span><span class="comment">-- =&gt; 2 x
</span>
</pre>


<h3>values</h3>

<p>Collects the values of an object properties:</p>


<pre>
_.each(_.values({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span>
_.each(_.values({x = <span class="number">0</span>, y = <span class="number">1</span>}),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 0
</span>
</pre>


<h3>paired</h3>

<p>Collects and returns each value-pairs in an array:</p>


<pre>
<span class="keyword">local</span> Pairs = _.paired({<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>})
_.each(Pairs, <span class="keyword">function</span>(k,v)
  <span class="global">print</span>(<span class="string">'Pair'</span>,k,v[<span class="number">1</span>],v[<span class="number">2</span>])
<span class="keyword">end</span>)

<span class="comment">-- =&gt; Pair 1 1 a
</span><span class="comment">-- =&gt; Pair 2 2 b
</span><span class="comment">-- =&gt; Pair 3 3 c
</span>
</pre>


<h3>extend</h3>

<p>Extends an object with properties of source objects:</p>


<pre>
<span class="keyword">local</span> obj = {}
_.extend(obj,{a = <span class="string">'b'</span>, c = <span class="string">'d'</span>})
_.each(obj,<span class="global">print</span>)

<span class="comment">-- =&gt; a b
</span><span class="comment">-- =&gt; c d
</span>
</pre>


<h3>functions</h3>

<p>Returns all functions names within an object:</p>


<pre>
_.each(_.functions(<span class="global">package</span>),<span class="global">print</span>)

<span class="comment">-- =&gt; 1 loadlib
</span><span class="comment">-- =&gt; 2 seeall
</span>
_.each(_.functions(<span class="global">coroutine</span>),<span class="global">print</span>)

<span class="comment">-- =&gt; 1    create
</span><span class="comment">-- =&gt; 2 resume
</span><span class="comment">-- =&gt; 3 running
</span><span class="comment">-- =&gt; 4 status
</span><span class="comment">-- =&gt; 5 wrap
</span><span class="comment">-- =&gt; 6 yield
</span>
</pre>


<h3>clone</h3>

<p>Clones a given object:</p>


<pre>
<span class="keyword">local</span> obj = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}
<span class="keyword">local</span> obj2 = _.clone(obj)
<span class="global">print</span>(obj2 == obj)
_.each(obj2,<span class="global">print</span>)

<span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span>
</pre>


<h3>tap</h3>

<p>Invokes agiven interceptor function on some object, and then returns the object itself. Useful to tap-into method chain to hook intermediate results.
The pased-interceptor is prototyped as <code>f(obj,...)</code>.</p>


<pre>
<span class="keyword">local</span> v = _.chain({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>)
    :filter(<span class="keyword">function</span>(k,v) <span class="keyword">return</span> v%<span class="number">2</span>~=<span class="number">0</span> <span class="keyword">end</span>) <span class="comment">-- filters even values
</span> tap(<span class="keyword">function</span>(v) <span class="global">print</span>(<span class="string">'Max is'</span>, _.max(v) <span class="keyword">end</span>) <span class="comment">-- Catches the max values and prints it
</span> :map(<span class="keyword">function</span>(k,v) <span class="keyword">return</span> k^<span class="number">2</span>)
    :value()

<span class="comment">-- =&gt;   Max is 9
</span>
</pre>


<h3>has</h3>

<p>Checks if an object has an attribute:</p>


<pre>
<span class="global">print</span>(_,<span class="string">'has'</span>)
<span class="global">print</span>(<span class="global">coroutine</span>,<span class="string">'resume'</span>)
<span class="global">print</span>(<span class="global">math</span>,<span class="string">'random'</span>)

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span>
</pre>


<h3>pick</h3>

<p>Collects whilelisted properties of a given object:</p>


<pre>
<span class="keyword">local</span> object = {a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>}
<span class="keyword">local</span> picked = _.pick(object,<span class="string">'a'</span>,<span class="string">'c'</span>)
_.each(picked,<span class="global">print</span>)

<span class="comment">-- =&gt; a 1
</span><span class="comment">-- =&gt; c 3
</span>
</pre>


<h3>omit</h3>

<p>Omits blacklisted properties of a given object:</p>


<pre>
<span class="keyword">local</span> object = {a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>}
<span class="keyword">local</span> picked = _.omit(object,<span class="string">'a'</span>,<span class="string">'c'</span>)
_.each(picked,<span class="global">print</span>)

<span class="comment">-- =&gt; b 2
</span>
</pre>


<h3>template</h3>

<p>Applies a template on an object, preserving existing properties:</p>


<pre>
<span class="keyword">local</span> obj = {a = <span class="number">0</span>}
_.template(obj,{a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>})
_.each(obj,<span class="global">print</span>)

<span class="comment">-- =&gt; a 0
</span><span class="comment">-- =&gt; c 3
</span><span class="comment">-- =&gt; b 2
</span>
</pre>


<h3>isEqual</h3>

<p>Compares objects:</p>


<pre>
<span class="global">print</span>(_.isEqual(<span class="number">1</span>,<span class="number">1</span>))
<span class="global">print</span>(_.isEqual(<span class="keyword">true</span>,<span class="keyword">false</span>))
<span class="global">print</span>(_.isEqual(<span class="number">3.14</span>,<span class="global">math</span>.pi))
<span class="global">print</span>(_.isEqual({<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>},{<span class="number">3</span>,<span class="number">4</span>,{<span class="number">5</span>}}))

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>result</h3>

<p>Calls an object method, passing it as a first arg the object itself:</p>


<pre>
<span class="global">print</span>(_.result(<span class="string">'abc'</span>,<span class="string">'len'</span>))
<span class="global">print</span>(_.result({<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>},<span class="global">table</span>.concat))

<span class="comment">-- =&gt; 3
</span><span class="comment">-- =&gt; abc
</span>
</pre>


<h3>isTable</h3>

<p>Is the given arg an object (i.e a Lua table) ?</p>


<pre>
<span class="global">print</span>(_.isTable({}))
<span class="global">print</span>(_.isTable(<span class="global">math</span>))
<span class="global">print</span>(_.isTable(<span class="global">string</span>))

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span>
</pre>


<h3>isCallable</h3>

<p>Is the given arg callable ?</p>


<pre>
<span class="global">print</span>(_.isCallable(<span class="global">print</span>))
<span class="global">print</span>(_.isCallable(<span class="keyword">function</span>() <span class="keyword">end</span>))
<span class="global">print</span>(_.isCallable(<span class="global">setmetatable</span>({},{__index = <span class="global">string</span>}).upper))
<span class="global">print</span>(_.isCallable(<span class="global">setmetatable</span>({},{__call = <span class="keyword">function</span>() <span class="keyword">return</span> <span class="keyword">end</span>})))

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span>
</pre>


<h3>isArray</h3>

<p>Is the given arg an array (table  with numeric keys) ?</p>


<pre>
<span class="global">print</span>(_.isArray({}))
<span class="global">print</span>(_.isArray({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}))
<span class="global">print</span>(_.isArray({<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>}))

<span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span>
</pre>


<h3>isEmpty</h3>

<p>Is the given arg empty ?</p>


<pre>
<span class="global">print</span>(_.isEmpty(<span class="string">''</span>))
<span class="global">print</span>(_.isEmpty({}))
<span class="global">print</span>(_.isEmpty({<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>}))

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>isString</h3>

<p>Is the given arg a string ?</p>


<pre>
<span class="global">print</span>(_.isString(<span class="string">''</span>))
<span class="global">print</span>(_.isString(<span class="string">'Hello'</span>))
<span class="global">print</span>(_.isString({})

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>isFunction</h3>

<p>Is the given arg a function ?</p>


<pre>
<span class="global">print</span>(_.isFunction(<span class="global">print</span>))
<span class="global">print</span>(_.isFunction(<span class="keyword">function</span>() <span class="keyword">end</span>))
<span class="global">print</span>(_.isFunction({})

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>isNil</h3>

<p>Is the given arg nil ?</p>


<pre>
<span class="global">print</span>(_.isNil(<span class="keyword">nil</span>))
<span class="global">print</span>(_.isNil())
<span class="global">print</span>(_.isNil({})

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>isNumber</h3>

<p>Is the given arg a number ?</p>


<pre>
<span class="global">print</span>(_.isNumber(<span class="global">math</span>.pi))
<span class="global">print</span>(_.isNumber(<span class="global">math</span>.huge))
<span class="global">print</span>(_.isNumber(<span class="number">0</span>/<span class="number">0</span>))
<span class="global">print</span>(_.isNumber())

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>isFinite</h3>

<p>Is the given arg a finite number ?</p>


<pre>
<span class="global">print</span>(_.isFinite(<span class="number">99e99</span>))
<span class="global">print</span>(_.isFinite(<span class="global">math</span>.pi))
<span class="global">print</span>(_.isFinite(<span class="global">math</span>.huge))
<span class="global">print</span>(_.isFinite(<span class="number">1</span>/<span class="number">0</span>))
<span class="global">print</span>(_.isFinite(<span class="number">0</span>/<span class="number">0</span>))

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>isNaN</h3>

<p>Is the given arg NaN ?</p>


<pre>
<span class="global">print</span>(_.isNaN(<span class="number">1</span>))
<span class="global">print</span>(_.isNaN(<span class="number">0</span>/<span class="number">0</span>))

<span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; true
</span>
</pre>


<h3>isBoolean</h3>

<p>Is the given arg a boolean ?</p>


<pre>
<span class="global">print</span>(_.isBoolean(<span class="keyword">true</span>))
<span class="global">print</span>(_.isBoolean(<span class="keyword">false</span>))
<span class="global">print</span>(_.isBoolean(<span class="number">1</span>==<span class="number">1</span>))
<span class="global">print</span>(_.isBoolean(<span class="global">print</span>))

<span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; false
</span>
</pre>


<h3>isInteger</h3>

<p>Is the given arg an integer ?</p>


<pre>
<span class="global">print</span>(_.isInteger(<span class="global">math</span>.pi))
<span class="global">print</span>(_.isInteger(<span class="number">1</span>))
<span class="global">print</span>(_.isInteger(-<span class="number">1</span>))

<span class="comment">-- =&gt; false
</span><span class="comment">-- =&gt; true
</span><span class="comment">-- =&gt; true
</span>
</pre>


<h3>import</h3>

<p>All library functions can be imported in a context using <a href="../index.html#import">import</a> </p>


<pre>
<span class="keyword">local</span> context = {}
_.import(context)

context.each({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span><span class="comment">-- ...
</span>
</pre>


<p>When no <code>context</code> was provided, it defaults to the global environment <code>_G</code></p>


<pre>
_.import()

each({<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>},<span class="global">print</span>)

<span class="comment">-- =&gt; 1 1
</span><span class="comment">-- =&gt; 2 2
</span><span class="comment">-- =&gt; 3 3
</span><span class="comment">-- ...
</span>
</pre>


<p>Passing <code>noConfilt</code> arg leaves untouched conflicting keys while importing into the context:</p>


<pre>
<span class="keyword">local</span> context = {each = <span class="number">1</span>}
_.import(context, <span class="keyword">true</span>)

<span class="global">print</span>(context.each)

<span class="comment">-- =&gt; 1
</span>
</pre>


<p><a name="Chaining"></a></p>
<h2>Chaining</h2>

<p><em>Method chaining</em> (also known as <em>name parameter idiom</em>), is a technique for invoking consecutively method calls in object-oriented style.
Each method returns an object, and methods calls are chained together.
Moses offers chaining (for your perusal) through a simple and easy-to-use interface.</p>

<p>Let's use chaining to get the count of evey single word in some lyrics (without making any difference between lowercase and uppercase words).</p>



<pre>
<span class="keyword">local</span> lyrics = {
  <span class="string">"I am a lumberjack and I am okay"</span>,
  <span class="string">"I sleep all night and I work all day"</span>,
  <span class="string">"He is a lumberjack and he is okay"</span>,
  <span class="string">"He sleeps all night and he works all day"</span>
}

<span class="keyword">local</span> stats = _.chain(lyrics)
  :map(<span class="keyword">function</span>(k,line)
    <span class="keyword">local</span> t = {}
    <span class="keyword">for</span> w <span class="keyword">in</span> line:gmatch(<span class="string">'(%w+)'</span>) <span class="keyword">do</span>
        t[#t+<span class="number">1</span>] = w
    <span class="keyword">end</span>
    <span class="keyword">return</span> t
  <span class="keyword">end</span>)
  :flatten()
  :countBy(<span class="keyword">function</span>(i,v) <span class="keyword">return</span> v:lower() <span class="keyword">end</span>)
  :value()

_.each(stats, <span class="global">print</span>)

<span class="comment">-- =&gt; sleep    1
</span><span class="comment">-- =&gt; night 2
</span><span class="comment">-- =&gt; works 1
</span><span class="comment">-- =&gt; am    2
</span><span class="comment">-- =&gt; is    2
</span><span class="comment">-- =&gt; sleeps    1
</span><span class="comment">-- =&gt; He    2
</span><span class="comment">-- =&gt; and   4
</span><span class="comment">-- =&gt; I 4
</span><span class="comment">-- =&gt; he    2
</span><span class="comment">-- =&gt; day   2
</span><span class="comment">-- =&gt; a 2
</span><span class="comment">-- =&gt; work  1
</span><span class="comment">-- =&gt; all   4
</span><span class="comment">-- =&gt; okay  2
</span>
</pre>


<p>For convenience, you can also use <code>_(value)</code> to chain methods, instead of <code>_.chain(value)</code>.</p>

<p>When chaining, each method returns to its successor a wrapped object. To get the expected result, you will have to unwrap the result
by calling method <code>value()</code></p>


<pre>
<span class="keyword">local</span> t = {<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>}
<span class="global">print</span>(_(a):value() == _.chain(value):value())
</pre>


<p><a name="License"></a></p>
<h2>License</h2>
<p>This work is under <a href="http://www.opensource.org/licenses/mit-license.php">MIT-LICENSE</a><br/>
Copyright (c) 2012-2014 Roland Yonaba

</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.0</a></i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
